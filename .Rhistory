mutate(
X_Harm_c = X_Harm_Index - mean(X_Harm_Index, na.rm = TRUE),
Inst_Trust_c = Inst_Trust_Index - mean(Inst_Trust_Index, na.rm = TRUE)
)
# 4. Regional Regression Models
# Research Question: Does Trust buffer the negative effect of Harm on Impact View?
model_hkg <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Hong Kong"))
model_sgp <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Singapore"))
model_twn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Taiwan"))
model_chn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "China"))
model_usa <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "USA"))
model_can <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Canada"))
# 5. Comparative Full Model (Testing Regional Differences in Interaction)
model_full <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c * Region + Neighbor_Dislike + Edu + Income + Age, data = df_clean)
# 6. Visualization and Tabulation
tab_model(model_hkg, model_sgp, model_twn, model_chn, model_usa, model_can,
dv.labels = c("HK", "SG", "TW", "CN", "USA", "CAN"),
pred.labels = c(
"X_Harm_c" = "Perceived Harm (X)",
"Inst_Trust_c" = "Inst. Trust Index (W)",
"X_Harm_c:Inst_Trust_c" = "Harm × Trust (Interaction)",
"Neighbor_Dislike" = "Neighbor Dislike (Dummy)"
),
string.est = "Coef (B)", p.style = "stars")
plot_model(model_full, type = "int", title = "The Buffering Effect: Institutional Trust Across Regions")
dta$B_COUNTRY_num <- as.numeric(dta$B_COUNTRY)
#extract needed variables
df_analysis <- dta %>%
filter(B_COUNTRY_num %in% c(344, 702, 158, 156, 840, 124)) %>%
select(
Country = B_COUNTRY_num,
Q121, # DV: Overall impact of immigrants (1-5, 5=Very Good)
Q124, Q126, Q128, Q129, # views items: Perceived harms (Crime, Terror, Jobs, Conflict)(0-2,2 means agree, which is the most negative views on immigrants)
Q69, Q70, Q71, Q74,     # Government items: Trust (Police, Courts, Gov, Civil Service)(1-4,1 means trust the most)
Q21,                    # Neighbor Preference (Immigrants/Foreign workers)(1 is dislike, 2 is did not meantion)
Q275, Q288, Q262        # Controls: Education(1-8,larger better), Income(1-10, larger better), Age
) %>%
zap_labels() %>%
mutate(across(everything(), as.numeric))
# reorgnize the variables
df_clean <- df_analysis %>%
# Convert WVS negative codes (-1 to -5) to R's NA
mutate(across(everything(), ~ifelse(.x < 0, NA, .x))) %>%
mutate(
Region = factor(Country,
levels = c(344, 702, 158, 156, 840, 124),
labels = c("Hong Kong", "Singapore", "Taiwan", "China", "USA", "Canada")),
# Dependent Variable: General View (High = Positive)
ImpactOnCountry = Q121,
# Independent Variable: Multi-dimensional Harm Index (0-2)
X_Harm_Index = rowMeans(across(c(Q124, Q126, Q128, Q129)), na.rm = TRUE),
# Moderator: Institutional Trust Index (Combined Q69, Q70, Q71, Q74)
# Recoded: 5 - original score so that 4 = High Trust, 1 = No Trust
Inst_Trust_Index = rowMeans(across(c(Q69, Q70, Q71, Q74), ~ 5 - .x), na.rm = TRUE),
# Dummy Variable: Personal Neighbor Preference (Q21)
# 1 = Mentioned (Dislikes immigrant neighbors), 0 = Not mentioned (Accepts/Neutral)
Neighbor_Dislike = ifelse(Q21 == 1, 1, 0),
Edu = Q275, Income = Q288, Age = Q262
) %>%
# Remove cases with missing values in key analytical variables
drop_na(ImpactOnCountry, X_Harm_Index, Inst_Trust_Index, Edu)
# 3. Statistical Mean-Centering for Moderation Analysis
df_clean <- df_clean %>%
mutate(
X_Harm_c = X_Harm_Index - mean(X_Harm_Index, na.rm = TRUE),
Inst_Trust_c = Inst_Trust_Index - mean(Inst_Trust_Index, na.rm = TRUE)
)
# 4. Regional Regression Models
# Research Question: Does Trust buffer the negative effect of Harm on Impact View?
model_hkg <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Hong Kong"))
model_sgp <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Singapore"))
model_twn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Taiwan"))
model_chn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "China"))
model_usa <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "USA"))
model_can <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Canada"))
# 5. Comparative Full Model (Testing Regional Differences in Interaction)
model_full <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c * Region + Neighbor_Dislike + Edu + Income + Age, data = df_clean)
# 6. Visualization and Tabulation
tab_model(model_hkg, model_sgp, model_twn, model_chn, model_usa, model_can,
dv.labels = c("HK", "SG", "TW", "CN", "USA", "CAN"),
pred.labels = c(
"X_Harm_c" = "Perceived Harm (X)",
"Inst_Trust_c" = "Inst. Trust Index (W)",
"X_Harm_c:Inst_Trust_c" = "Harm × Trust (Interaction)",
"Neighbor_Dislike" = "Neighbor Dislike (Dummy)"
),
string.est = "Coef (B)", p.style = "stars")
plot_model(model_full, type = "int", title = "The Buffering Effect: Institutional Trust Across Regions")
dta$B_COUNTRY_num <- as.numeric(dta$B_COUNTRY)
df_analysis <- dta %>%
filter(B_COUNTRY_num %in% c(344, 702, 158, 156, 840, 124)) %>%
select(
Country = B_COUNTRY_num,
Q21,                    # DV: Neighbor Preference (1=dislike, 2=did not mention)
Q124, Q126, Q128, Q129, # X-items: Perceived harms (0-2, 2=agree/negative)
Q69, Q70, Q71, Q74,     # W-items: Trust (1-4, 1=trust most)
Q121,                   # Control: General Impact View (1-5, 5=very good)
Q275, Q288, Q262        # Controls: Edu (1-8), Income (1-10), Age
) %>%
zap_labels() %>%
mutate(across(everything(), as.numeric))
# 2. Data Cleaning and Probit Preparation
df_clean <- df_analysis %>%
mutate(across(everything(), ~ifelse(.x < 0, NA, .x))) %>%
mutate(
Region = factor(Country,
levels = c(344, 702, 158, 156, 840, 124),
labels = c("Hong Kong", "Singapore", "Taiwan", "China", "USA", "Canada")),
# Dependent Variable (Binary for Probit):
# 1 = Accepts Immigrant Neighbors (Did not mention 'dislike')
# 0 = Dislikes Immigrant Neighbors (Mentioned in Q21)
Wants_Neighbor = ifelse(Q21 == 2, 1, 0),
# Independent Variable: Multi-dimensional Harm Index
X_Harm_Index = rowMeans(across(c(Q124, Q126, Q128, Q129)), na.rm = TRUE),
# Moderator: Institutional Trust Index (5 - score to make 4 = High Trust)
Inst_Trust_Index = rowMeans(across(c(Q69, Q70, Q71, Q74), ~ 5 - .x), na.rm = TRUE),
# Reasonable Controls
ImpactView = Q121,
Edu = Q275,
Income = Q288,
Age = Q262
) %>%
drop_na(Wants_Neighbor, X_Harm_Index, Inst_Trust_Index, Edu)
# 3. Mean-Centering
df_clean <- df_clean %>%
mutate(
X_Harm_c = X_Harm_Index - mean(X_Harm_Index, na.rm = TRUE),
Inst_Trust_c = Inst_Trust_Index - mean(Inst_Trust_Index, na.rm = TRUE)
)
# 4. Probit Models (GLM with binomial family and probit link)
# Formula: Probability of wanting neighbor ~ Perceived Harm * Trust + Controls
model_probit_hkg <- glm(Wants_Neighbor ~ X_Harm_c * Inst_Trust_c + Edu + Income + Age,
data = filter(df_clean, Region == "Hong Kong"), family = binomial(link = "probit"))
model_probit_sgp <- glm(Wants_Neighbor ~ X_Harm_c * Inst_Trust_c + Edu + Income + Age,
data = filter(df_clean, Region == "Singapore"), family = binomial(link = "probit"))
model_probit_twn <- glm(Wants_Neighbor ~ X_Harm_c * Inst_Trust_c + Edu + Income + Age,
data = filter(df_clean, Region == "Taiwan"), family = binomial(link = "probit"))
model_probit_chn <- glm(Wants_Neighbor ~ X_Harm_c * Inst_Trust_c + Edu + Income + Age,
data = filter(df_clean, Region == "China"), family = binomial(link = "probit"))
model_probit_usa <- glm(Wants_Neighbor ~ X_Harm_c * Inst_Trust_c + Edu + Income + Age,
data = filter(df_clean, Region == "USA"), family = binomial(link = "probit"))
model_probit_can <- glm(Wants_Neighbor ~ X_Harm_c * Inst_Trust_c + Edu + Income + Age,
data = filter(df_clean, Region == "Canada"), family = binomial(link = "probit"))
# 5. Full Probit Model
model_probit_full <- glm(Wants_Neighbor ~ X_Harm_c * Inst_Trust_c * Region + Edu + Income + Age,
data = df_clean, family = binomial(link = "probit"))
# 6. Professional Table Output
tab_model(model_probit_hkg, model_probit_sgp, model_probit_twn,
model_probit_chn, model_probit_usa, model_probit_can,
dv.labels = c("HK", "SG", "TW", "CN", "USA", "CAN"),
title = "Probit Model: Probability of Accepting Immigrants as Neighbors",
string.est = "Estimate (z)", p.style = "stars")
# 7. Visualization of Probabilities
plot_model(model_probit_full, type = "int",
title = "Probit Interaction: Probability of Accepting Neighbors")
dta$B_COUNTRY_num <- as.numeric(dta$B_COUNTRY)
#extract needed variables
df_analysis <- dta %>%
filter(B_COUNTRY_num %in% c(344, 702, 158, 156, 840, 124)) %>%
select(
Country = B_COUNTRY_num,
Q121, # DV: Overall impact of immigrants (1-5, 5=Very Good)
Q124, Q126, Q128, Q129, # views items: Perceived harms (Crime, Terror, Jobs, Conflict)(0-2,2 means agree, which is the most negative views on immigrants)
Q69, Q70, Q71, Q74,     # Government items: Trust (Police, Courts, Gov, Civil Service)(1-4,1 means trust the most)
Q21,                    # Neighbor Preference (Immigrants/Foreign workers)(1 is dislike, 2 is did not meantion)
Q275, Q288, Q262        # Controls: Education(1-8,larger better), Income(1-10, larger better), Age
) %>%
zap_labels() %>%
mutate(across(everything(), as.numeric))
# reorgnize the variables
df_clean <- df_analysis %>%
# Convert WVS negative codes (-1 to -5) to R's NA
mutate(across(everything(), ~ifelse(.x < 0, NA, .x))) %>%
mutate(
Region = factor(Country,
levels = c(344, 702, 158, 156, 840, 124),
labels = c("Hong Kong", "Singapore", "Taiwan", "China", "USA", "Canada")),
# Dependent Variable: General View (High = Positive)
ImpactOnCountry = Q121,
# Independent Variable: Multi-dimensional Harm Index (0-2)
X_Harm_Index = rowMeans(across(c(Q124, Q126, Q128, Q129)), na.rm = TRUE),
# Moderator: Institutional Trust Index (Combined Q69, Q70, Q71, Q74)
# Recoded: 5 - original score so that 4 = High Trust, 1 = No Trust
Inst_Trust_Index = rowMeans(across(c(Q69, Q70, Q71, Q74), ~ 5 - .x), na.rm = TRUE),
# Dummy Variable: Personal Neighbor Preference (Q21)
# 1 = Mentioned (Dislikes immigrant neighbors), 0 = Not mentioned (Accepts/Neutral)
Neighbor_Dislike = ifelse(Q21 == 1, 1, 0),
Edu = Q275, Income = Q288, Age = Q262
) %>%
# Remove cases with missing values in key analytical variables
drop_na(ImpactOnCountry, X_Harm_Index, Inst_Trust_Index, Edu)
# 3. Statistical Mean-Centering for Moderation Analysis
df_clean <- df_clean %>%
mutate(
X_Harm_c = X_Harm_Index - mean(X_Harm_Index, na.rm = TRUE),
Inst_Trust_c = Inst_Trust_Index - mean(Inst_Trust_Index, na.rm = TRUE)
)
# 4. Regional Regression Models
# Research Question: Does Trust buffer the negative effect of Harm on Impact View?
model_hkg <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Hong Kong"))
model_sgp <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Singapore"))
model_twn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Taiwan"))
model_chn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "China"))
model_usa <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "USA"))
model_can <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Canada"))
model_full <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c * Region + Neighbor_Dislike + Edu + Income + Age, data = df_clean)
tab_model(model_hkg, model_sgp, model_twn, model_chn, model_usa, model_can,
dv.labels = c("HK", "SG", "TW", "CN", "USA", "CAN"),
pred.labels = c(
"X_Harm_c" = "Perceived Harm (X)",
"Inst_Trust_c" = "Inst. Trust Index (W)",
"X_Harm_c:Inst_Trust_c" = "Harm × Trust (Interaction)",
"Neighbor_Dislike" = "Neighbor Dislike (Dummy)"
),
string.est = "Coef (B)", p.style = "stars")
plot_model(model_full, type = "int", title = "The Buffering Effect: Institutional Trust Across Regions")
model_hkg_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Hong Kong"))
model_sgp_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Singapore"))
model_twn_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Taiwan"))
model_chn_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "China"))
model_usa_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "USA"))
model_can_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Canada"))
# 2. Full Additive Model (Controlled by Region)
model_full_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Region + Neighbor_Dislike + Edu + Income + Age,
data = df_clean)
# 3. Summary Table
tab_model(model_hkg_add, model_sgp_add, model_twn_add, model_chn_add, model_usa_add, model_can_add,
dv.labels = c("HK", "SG", "TW", "CN", "USA", "CAN"),
title = "Additive Model Results (Without Interaction Terms)",
string.est = "Coef (B)", p.style = "stars")
library(pacman)
p_load(tidyverse,ggplot2,haven,interactions,sjPlot,psych)
dta <- readRDS("data/WVS_Cross-National_Wave_7_rds_v6_0.rds")
dta$B_COUNTRY_num <- as.numeric(dta$B_COUNTRY)
#extract needed variables
df_analysis <- dta %>%
filter(B_COUNTRY_num %in% c(344, 702, 158, 156, 840, 124)) %>%
select(
Country = B_COUNTRY_num,
Q121, # DV: Overall impact of immigrants (1-5, 5=Very Good)
Q124, Q126, Q128, Q129, # views items: Perceived harms (Crime, Terror, Jobs, Conflict)(0-2,2 means agree, which is the most negative views on immigrants)
Q69, Q70, Q71, Q74,     # Government items: Trust (Police, Courts, Gov, Civil Service)(1-4,1 means trust the most)
Q21,                    # Neighbor Preference (Immigrants/Foreign workers)(1 is dislike, 2 is did not meantion)
Q275, Q288, Q262        # Controls: Education(1-8,larger better), Income(1-10, larger better), Age
) %>%
zap_labels() %>%
mutate(across(everything(), as.numeric))
# reorgnize the variables
df_clean <- df_analysis %>%
# Convert WVS negative codes (-1 to -5) to R's NA
mutate(across(everything(), ~ifelse(.x < 0, NA, .x))) %>%
mutate(
Region = factor(Country,
levels = c(344, 702, 158, 156, 840, 124),
labels = c("Hong Kong", "Singapore", "Taiwan", "China", "USA", "Canada")),
# Dependent Variable: General View (High = Positive)
ImpactOnCountry = Q121,
# Independent Variable: Multi-dimensional Harm Index (0-2)
X_Harm_Index = rowMeans(across(c(Q124, Q126, Q128, Q129)), na.rm = TRUE),
# Moderator: Institutional Trust Index (Combined Q69, Q70, Q71, Q74)
# Recoded: 5 - original score so that 4 = High Trust, 1 = No Trust
Inst_Trust_Index = rowMeans(across(c(Q69, Q70, Q71, Q74), ~ 5 - .x), na.rm = TRUE),
# Dummy Variable: Personal Neighbor Preference (Q21)
# 1 = Mentioned (Dislikes immigrant neighbors), 0 = Not mentioned (Accepts/Neutral)
Neighbor_Dislike = ifelse(Q21 == 1, 1, 0),
Edu = Q275, Income = Q288, Age = Q262
) %>%
# Remove cases with missing values in key analytical variables
drop_na(ImpactOnCountry, X_Harm_Index, Inst_Trust_Index, Edu)
# 3. Statistical Mean-Centering for Moderation Analysis
df_clean <- df_clean %>%
mutate(
X_Harm_c = X_Harm_Index - mean(X_Harm_Index, na.rm = TRUE),
Inst_Trust_c = Inst_Trust_Index - mean(Inst_Trust_Index, na.rm = TRUE)
)
# 4. Regional Regression Models
# Research Question: Does Trust buffer the negative effect of Harm on Impact View?
model_hkg <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Hong Kong"))
model_sgp <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Singapore"))
model_twn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Taiwan"))
model_chn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "China"))
model_full <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c * Region + Neighbor_Dislike + Edu + Income + Age, data = df_clean)
tab_model(model_hkg, model_sgp, model_twn, model_chn, model_usa, model_can,
dv.labels = c("HK", "SG", "TW", "CN"),
pred.labels = c(
"X_Harm_c" = "Perceived Harm (X)",
"Inst_Trust_c" = "Inst. Trust Index (W)",
"X_Harm_c:Inst_Trust_c" = "Harm × Trust (Interaction)",
"Neighbor_Dislike" = "Neighbor Dislike (Dummy)"
),
string.est = "Coef (B)", p.style = "stars")
plot_model(model_full, type = "int", title = "The Buffering Effect: Institutional Trust Across Regions")
model_hkg_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Hong Kong"))
model_sgp_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Singapore"))
model_twn_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Taiwan"))
# 2. Full Additive Model (Controlled by Region)
model_full_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Region + Neighbor_Dislike + Edu + Income + Age,
data = df_clean)
# 3. Summary Table
tab_model(model_hkg_add, model_sgp_add, model_twn_add, model_chn_add, model_usa_add, model_can_add,
dv.labels = c("HK", "SG", "TW", "CN"),
title = "Additive Model Results (Without Interaction Terms)",
string.est = "Coef (B)", p.style = "stars")
library(pacman)
p_load(tidyverse,ggplot2,haven,interactions,sjPlot,psych)
dta <- readRDS("data/WVS_Cross-National_Wave_7_rds_v6_0.rds")
dta$B_COUNTRY_num <- as.numeric(dta$B_COUNTRY)
#extract needed variables
df_analysis <- dta %>%
filter(B_COUNTRY_num %in% c(344, 702, 158, 156, 840, 124)) %>%
select(
Country = B_COUNTRY_num,
Q121, # DV: Overall impact of immigrants (1-5, 5=Very Good)
Q124, Q126, Q128, Q129, # views items: Perceived harms (Crime, Terror, Jobs, Conflict)(0-2,2 means agree, which is the most negative views on immigrants)
Q69, Q70, Q71, Q74,     # Government items: Trust (Police, Courts, Gov, Civil Service)(1-4,1 means trust the most)
Q21,                    # Neighbor Preference (Immigrants/Foreign workers)(1 is dislike, 2 is did not meantion)
Q275, Q288, Q262        # Controls: Education(1-8,larger better), Income(1-10, larger better), Age
) %>%
zap_labels() %>%
mutate(across(everything(), as.numeric))
# reorgnize the variables
df_clean <- df_analysis %>%
# Convert WVS negative codes (-1 to -5) to R's NA
mutate(across(everything(), ~ifelse(.x < 0, NA, .x))) %>%
mutate(
Region = factor(Country,
levels = c(344, 702, 158, 156, 840, 124),
labels = c("Hong Kong", "Singapore", "Taiwan", "China", "USA", "Canada")),
# Dependent Variable: General View (High = Positive)
ImpactOnCountry = Q121,
# Independent Variable: Multi-dimensional Harm Index (0-2)
X_Harm_Index = rowMeans(across(c(Q124, Q126, Q128, Q129)), na.rm = TRUE),
# Moderator: Institutional Trust Index (Combined Q69, Q70, Q71, Q74)
# Recoded: 5 - original score so that 4 = High Trust, 1 = No Trust
Inst_Trust_Index = rowMeans(across(c(Q69, Q70, Q71, Q74), ~ 5 - .x), na.rm = TRUE),
# Dummy Variable: Personal Neighbor Preference (Q21)
# 1 = Mentioned (Dislikes immigrant neighbors), 0 = Not mentioned (Accepts/Neutral)
Neighbor_Dislike = ifelse(Q21 == 1, 1, 0),
Edu = Q275, Income = Q288, Age = Q262
) %>%
# Remove cases with missing values in key analytical variables
drop_na(ImpactOnCountry, X_Harm_Index, Inst_Trust_Index, Edu)
# 3. Statistical Mean-Centering for Moderation Analysis
df_clean <- df_clean %>%
mutate(
X_Harm_c = X_Harm_Index - mean(X_Harm_Index, na.rm = TRUE),
Inst_Trust_c = Inst_Trust_Index - mean(Inst_Trust_Index, na.rm = TRUE)
)
# 4. Regional Regression Models
# Research Question: Does Trust buffer the negative effect of Harm on Impact View?
model_hkg <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Hong Kong"))
model_sgp <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Singapore"))
model_twn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Taiwan"))
model_chn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "China"))
model_full <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c * Region + Neighbor_Dislike + Edu + Income + Age, data = df_clean)
tab_model(model_hkg, model_sgp, model_twn, model_chn,
dv.labels = c("HK", "SG", "TW", "CN"),
pred.labels = c(
"X_Harm_c" = "Perceived Harm (X)",
"Inst_Trust_c" = "Inst. Trust Index (W)",
"X_Harm_c:Inst_Trust_c" = "Harm × Trust (Interaction)",
"Neighbor_Dislike" = "Neighbor Dislike (Dummy)"
),
string.est = "Coef (B)", p.style = "stars")
plot_model(model_full, type = "int", title = "The Buffering Effect: Institutional Trust Across Regions")
model_hkg_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Hong Kong"))
model_sgp_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Singapore"))
model_twn_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Taiwan"))
# 2. Full Additive Model (Controlled by Region)
model_full_add <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Region + Neighbor_Dislike + Edu + Income + Age,
data = df_clean)
# 3. Summary Table
tab_model(model_hkg_add, model_sgp_add, model_twn_add, model_chn_add, model_usa_add, model_can_add,
dv.labels = c("HK", "SG", "TW", "CN"),
title = "Additive Model Results (Without Interaction Terms)",
string.est = "Coef (B)", p.style = "stars")
model_hkg_original <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Hong Kong"))
model_sgp_original <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Singapore"))
model_twn_original <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "Taiwan"))
model_chn_original <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age,
data = filter(df_clean, Region == "China"))
model_full_original <- lm(ImpactOnCountry ~ X_Harm_c + Inst_Trust_c + Region + Neighbor_Dislike + Edu + Income + Age,
data = df_clean)
tab_model(model_hkg_original, model_sgp_original, model_twn_original, model_chn_original,
dv.labels = c("HK", "SG", "TW", "CN"),
title = "Additive Model Results (Without Interaction Terms)",
string.est = "Coef (B)", p.style = "stars")
dta$B_COUNTRY_num <- as.numeric(dta$B_COUNTRY)
library(pacman)
p_load(tidyverse,ggplot2,haven,interactions,sjPlot,psych)
dta <- readRDS("data/WVS_Cross-National_Wave_7_rds_v6_0.rds")
dta$B_COUNTRY_num <- as.numeric(dta$B_COUNTRY)
#extract needed variables
df_analysis <- dta %>%
filter(B_COUNTRY_num %in% c(344, 702, 158, 156, 840, 124)) %>%
select(
Country = B_COUNTRY_num,
Q121, # DV: Overall impact of immigrants (1-5, 5=Very Good)
Q124, Q126, Q128, Q129, # views items: Perceived harms (Crime, Terror, Jobs, Conflict)(0-2,2 means agree, which is the most negative views on immigrants)
Q69, Q70, Q71, Q74,     # Government items: Trust (Police, Courts, Gov, Civil Service)(1-4,1 means trust the most)
#    Q21,        #This is causeing post-treatment effect. Neighbor Preference (Immigrants/Foreign workers)(1 is dislike, 2 is did not meantion)
Q275, Q288, Q262        # Controls: Education(1-8,larger better), Income(1-10, larger better), Age
) %>%
zap_labels() %>%
mutate(across(everything(), as.numeric))
# reorgnize the variables
df_clean <- df_analysis %>%
# Convert WVS negative codes (-1 to -5) to R's NA
mutate(across(everything(), ~ifelse(.x < 0, NA, .x))) %>%
mutate(
Region = factor(Country,
levels = c(344, 702, 158, 156, 840, 124),
labels = c("Hong Kong", "Singapore", "Taiwan", "China", "USA", "Canada")),
# Dependent Variable: General View (High = Positive)
ImpactOnCountry = Q121,
# Independent Variable: Multi-dimensional Harm Index (0-2)
X_Harm_Index = rowMeans(across(c(Q124, Q126, Q128, Q129)), na.rm = TRUE),
# Moderator: Institutional Trust Index (Combined Q69, Q70, Q71, Q74)
# Recoded: 5 - original score so that 4 = High Trust, 1 = No Trust
Inst_Trust_Index = rowMeans(across(c(Q69, Q70, Q71, Q74), ~ 5 - .x), na.rm = TRUE),
# Dummy Variable: Personal Neighbor Preference (Q21)
# This is causeing post-treatment effect.
# 1 = Mentioned (Dislikes immigrant neighbors), 0 = Not mentioned (Accepts/Neutral)
#Neighbor_Dislike = ifelse(Q21 == 1, 1, 0),
Edu = Q275, Income = Q288, Age = Q262
) %>%
# Remove cases with missing values in key analytical variables
drop_na(ImpactOnCountry, X_Harm_Index, Inst_Trust_Index, Edu)
# 3. Statistical Mean-Centering for Moderation Analysis
df_clean <- df_clean %>%
mutate(
X_Harm_c = X_Harm_Index - mean(X_Harm_Index, na.rm = TRUE),
Inst_Trust_c = Inst_Trust_Index - mean(Inst_Trust_Index, na.rm = TRUE)
)
# 4. Regional Regression Models
# Research Question: Does Trust buffer the negative effect of Harm on Impact View?
model_hkg <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c + Neighbor_Dislike + Edu + Income + Age, data = filter(df_clean, Region == "Hong Kong"))
dta$B_COUNTRY_num <- as.numeric(dta$B_COUNTRY)
#extract needed variables
df_analysis <- dta %>%
filter(B_COUNTRY_num %in% c(344, 702, 158, 156, 840, 124)) %>%
select(
Country = B_COUNTRY_num,
Q121, # DV: Overall impact of immigrants (1-5, 5=Very Good)
Q124, Q126, Q128, Q129, # views items: Perceived harms (Crime, Terror, Jobs, Conflict)(0-2,2 means agree, which is the most negative views on immigrants)
Q69, Q70, Q71, Q74,     # Government items: Trust (Police, Courts, Gov, Civil Service)(1-4,1 means trust the most)
#    Q21,        #This is causeing post-treatment effect. Neighbor Preference (Immigrants/Foreign workers)(1 is dislike, 2 is did not meantion)
Q275, Q288, Q262        # Controls: Education(1-8,larger better), Income(1-10, larger better), Age
) %>%
zap_labels() %>%
mutate(across(everything(), as.numeric))
# reorgnize the variables
df_clean <- df_analysis %>%
# Convert WVS negative codes (-1 to -5) to R's NA
mutate(across(everything(), ~ifelse(.x < 0, NA, .x))) %>%
mutate(
Region = factor(Country,
levels = c(344, 702, 158, 156, 840, 124),
labels = c("Hong Kong", "Singapore", "Taiwan", "China", "USA", "Canada")),
# Dependent Variable: General View (High = Positive)
ImpactOnCountry = Q121,
# Independent Variable: Multi-dimensional Harm Index (0-2)
X_Harm_Index = rowMeans(across(c(Q124, Q126, Q128, Q129)), na.rm = TRUE),
# Moderator: Institutional Trust Index (Combined Q69, Q70, Q71, Q74)
# Recoded: 5 - original score so that 4 = High Trust, 1 = No Trust
Inst_Trust_Index = rowMeans(across(c(Q69, Q70, Q71, Q74), ~ 5 - .x), na.rm = TRUE),
# Dummy Variable: Personal Neighbor Preference (Q21)
# This is causeing post-treatment effect.
# 1 = Mentioned (Dislikes immigrant neighbors), 0 = Not mentioned (Accepts/Neutral)
#Neighbor_Dislike = ifelse(Q21 == 1, 1, 0),
Edu = Q275, Income = Q288, Age = Q262
) %>%
# Remove cases with missing values in key analytical variables
drop_na(ImpactOnCountry, X_Harm_Index, Inst_Trust_Index, Edu)
# 3. Statistical Mean-Centering for Moderation Analysis
df_clean <- df_clean %>%
mutate(
X_Harm_c = X_Harm_Index - mean(X_Harm_Index, na.rm = TRUE),
Inst_Trust_c = Inst_Trust_Index - mean(Inst_Trust_Index, na.rm = TRUE)
)
# 4. Regional Regression Models
# Research Question: Does Trust buffer the negative effect of Harm on Impact View?
model_hkg <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c  + Edu + Income + Age, data = filter(df_clean, Region == "Hong Kong"))
model_sgp <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c  + Edu + Income + Age, data = filter(df_clean, Region == "Singapore"))
model_twn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c  + Edu + Income + Age, data = filter(df_clean, Region == "Taiwan"))
model_chn <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c  + Edu + Income + Age, data = filter(df_clean, Region == "China"))
model_full <- lm(ImpactOnCountry ~ X_Harm_c * Inst_Trust_c * Region  + Edu + Income + Age, data = df_clean)
tab_model(model_hkg, model_sgp, model_twn, model_chn,
dv.labels = c("HK", "SG", "TW", "CN"),
pred.labels = c(
"X_Harm_c" = "Perceived Harm (X)",
"Inst_Trust_c" = "Inst. Trust Index (W)",
"X_Harm_c:Inst_Trust_c" = "Harm × Trust (Interaction)",
"Neighbor_Dislike" = "Neighbor Dislike (Dummy)"
),
string.est = "Coef (B)", p.style = "stars")
plot_model(model_full, type = "int", title = "The Buffering Effect: Institutional Trust Across Regions")
